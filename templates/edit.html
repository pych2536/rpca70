{% extends "layout.html" %}
{% block title %}แก้ไขข้อมูล{% endblock %}
{% block content %}
<div class="container">
    <div class="card edit-card">
        <h2>แก้ไขข้อมูล</h2>
        <form action="{{ url_for('update', user_id=user['ลำดับ']) }}" method="post">
            <div class="form-grid">
        
                {% for col in columns %}
                    {# ทำให้ฟิล์ดที่ไม่ควรให้ user แก้ไข เป็นแบบอ่านได้อย่างเดียว #}
                    {% if col in ['ลำดับ', 'สถานะอัปเดต', 'วันที่อัปเดตล่าสุด'] %}
                        <div class="form-group">
                            <label for="{{ col }}">{{ col }}</label>
                            <input type="text" id="{{ col }}" name="{{ col }}" value="{{ user.get(col, '') }}" readonly class="readonly-field">
                        </div>
                    {% else %}
                        <div class="form-group">
                            <label for="{{ col }}">{{ col }}</label>
                            {# ใช้ textarea สำหรับฟิล์ดที่อยู่ #}
                            {% if col == 'ที่อยู่' %}
                                <textarea id="{{ col }}" name="{{ col }}" rows="3">{{ user.get(col, '') }}</textarea>
                            {% else %}
                                <input type="text" id="{{ col }}" name="{{ col }}" value="{{ user.get(col, '') }}">
                            {% endif %}
                        </div>
                    {% endif %}
                {% endfor %}
        
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">บันทึกการเปลี่ยนแปลง</button>
                <a href="{{ url_for('admin_dashboard') if admin_mode else url_for('view_profile', user_id=user['ลำดับ']) }}" class="btn btn-secondary">ยกเลิก</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
